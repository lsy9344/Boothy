# [기능 명세서] 브라운필드 프로젝트: 세션 타임라인 및 스마트 익스포트 고도화

## 1. 개요 (Overview)

* **목적:** 무인 운영 환경에 맞춰 엄격한 **세션 시간 제한(Time-boxing)**을 적용하고, **백그라운드 선행 처리 및 사용자 선택형 익스포트 프로세스**를 도입하여 대용량 파일 처리의 안정성과 사용자 편의성을 확보함.
* **적용 범위:** 메인 에디터, 라이브러리, 글로벌 백그라운드 프로세스.

## 2. 상세 기능 명세 (Functional Requirements)

### A. 세션 타임라인 관리 (Session Timeline Management)

**1. 세션 정의 및 타이머**

* **운영 시간:** 매 시 정각(N:00)부터 매 시 50분(N:50)까지를 하나의 세션으로 정의.
* **잔여 시간 표시:** 메인 에디터 및 라이브러리 화면 상단에 `N시 50분`까지 남은 시간을 `MM:SS` 형식으로 실시간 카운트다운 표시.
* **지각 입장 처리 (Edge Case):** 사용자가 N시 00분 이후(예: 14:45)에 세션명을 입력하고 입장하더라도, 종료 기준 시간은 해당 시의 50분(14:50)으로 고정됨.

**2. 시간대별 이벤트 트리거**

* **T-5분 (경고):** * 남은 시간이 `05:00`이 되는 순간, 화면 중앙에 **모달(Modal)** 창을 띄워 종료가 임박했음을 경고.
  * 사용자가 '확인' 버튼을 눌러야 모달이 닫히고 작업을 지속할 수 있음.
* **T-0분 (종료 및 강제 실행):** * 남은 시간이 `00:00` (N시 50분)이 되는 순간, 편집 기능을 차단(Lock)하고 즉시 **[B. 스마트 익스포트 프로세스]**를 강제로 실행.
* **N시 59분 (리셋):** * N시 59분이 되면 애플리케이션을 완전히 초기화하여 초기 화면(세션 입력 창)으로 리셋.

**3. 종료 대기 화면 (End Screen)**

* 익스포트가 완료된 후부터 59분 리셋 전까지 **종료 메시지**를 전체 화면으로 표시.
* **문구:** "이용해주셔서 감사합니다." (관리자 설정 파일 또는 Config에서 텍스트 수정 가능해야 함).
* **기능:** 추가 편집 및 조작 불가 상태 유지.

### B. 스마트 익스포트 프로세스 (Smart Export Process)

**1. 백그라운드 자동 처리 (Background Processing)**

* **상시 작동:** 시스템은 사용자가 별도의 동작을 하지 않는 유휴 시간(Idle time) 동안 `Raw` 폴더를 지속적으로 감시함.
* **선행 변환:** 새로운 사진 파일이 감지되면, 백그라운드에서 자동으로 1장씩 순차적으로 내보내기(Export) 처리를 수행하여 최종 대기 시간을 최소화함.

**2. 익스포트 실행 트리거 및 사용자 선택 (User Decision Flow)**

* **진입 조건:** * 사용자가 수동으로 'Export' 버튼을 클릭했을 때.
  * 또는 시간이 종료(T-0)되어 강제로 실행될 때.
* **의사 결정 모달 (Decision Modal):**
  * 실행 즉시 아래 메시지와 선택 버튼이 포함된 모달을 띄움.
  * **메시지:** "이미 대부분의 사진이 내보내기 완료됐어요. 모두 다시 내보낼까요? 이어서 내보낼까요?"
  * **버튼 1 [모두 덮어쓰기]:**
    * 이미 백그라운드에서 처리된 파일들을 무시하고, 모든 Raw 파일에 대해 처음부터 다시 내보내기 및 덮어쓰기를 수행함.
  * **버튼 2 [이어서 내보내기]:**
    * 백그라운드 처리가 완료된 파일은 건너뛰고, 아직 처리되지 않은 잔여 Raw 파일만 식별하여 내보내기를 수행함.

**3. 진행 상태 시각화 (Visual Feedback)**

* 선택된 방식(덮어쓰기 또는 이어서 하기)으로 처리가 진행되는 동안, 사용자가 완료 여부를 알 수 있도록 **게이지(Progress Bar)** 또는 **버퍼링 인디케이터**를 통해 진행률을 시각적으로 표시해야 함.

### C. UX/UI 및 네비게이션 변경 (Navigation Flow Changes)

**1. 진입 동선 최적화**

* 세션 이름 입력 완료 시, 라이브러리 화면을 거치지 않고 **즉시 메인 에디터 화면**으로 진입.

**2. 화면 간 이동**

* **에디터 → 라이브러리:**
  * 오른쪽 사이드바(Right Sidebar)에 **'사진첩' 모양 아이콘** 추가.
  * 해당 아이콘 클릭 시 라이브러리 화면으로 이동.
* **라이브러리 → 에디터:**
  * 라이브러리 화면 내 'HOME' 버튼의 라우팅 변경.
  * 클릭 시 초기 화면(세션 입력 창)이 아닌 **메인 에디터 화면**으로 복귀.
