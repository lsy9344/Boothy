# Story 2.5: Navigation Flow Optimization

## Status

Approved

## Story

**As a** booth user,  
**I want** streamlined navigation between editing and browsing,  
**so that** I spend less time clicking through screens.

[Source: docs/prd-session-timeline-smart-export.md#story-25-navigation-flow-optimization]

## Acceptance Criteria

1. Completing session name entry navigates directly to Editor screen (Library screen not shown).
2. Editor displays gallery icon in right sidebar (consistent with existing sidebar icon style).
3. Clicking gallery icon navigates to Library screen.
4. Library 'HOME' button navigates to Editor screen.
5. Navigation preserves selected photo, active preset, and session folder context.
6. Countdown timer remains visible and accurate across all navigation transitions.
7. All existing screens remain accessible (no functionality removed).

[Source: docs/prd-session-timeline-smart-export.md#story-25-navigation-flow-optimization]

## Tasks / Subtasks

- [ ] Task 1: Update session entry routing to go direct-to-editor (AC: 1)
  - [ ] Change the session entry completion handler to open the Editor view by default (if the app uses routes, this corresponds to navigating to `/editor`; if it uses internal view state, implement the equivalent state transition rather than introducing a new router).
    [Source: docs/prd-session-timeline-smart-export.md#story-25-navigation-flow-optimization]
    [Source: docs/frontend-architecture.md#core-views-mvp]
  - [ ] Ensure session creation/activation still happens before navigation (active session is required for editor/library context).
    [Source: docs/architecture/component-architecture.md#boothy-session-manager-tauri-backend]
    [Source: docs/frontend-architecture.md#core-views-mvp]
  - [ ] Likely touchpoints (verify in codebase): `apps/boothy/src/App.tsx` (session start + view composition) and the existing session entry UI.
    [Source: docs/stories/1.1.booth-app-foundation-session-mode-gating.md#dev-agent-record]

- [ ] Task 2: Add Editor gallery icon and route to Library (AC: 2, 3)
  - [ ] Add a gallery/photo-album icon to the Editor right sidebar, matching the existing iconography/style.
    [Source: docs/prd-session-timeline-smart-export.md#story-25-navigation-flow-optimization]
  - [ ] Wire icon click to open the Library view (if the app uses routes, navigate to `/library`; otherwise switch the existing view state).
    [Source: docs/prd-session-timeline-smart-export.md#story-25-navigation-flow-optimization]
  - [ ] Likely touchpoints (verify in codebase): `apps/boothy/src/components/panel/Editor.tsx` and/or `apps/boothy/src/components/panel/right/RightPanelSwitcher.tsx`.
    [Source: docs/stories/1.1.booth-app-foundation-session-mode-gating.md#dev-agent-record]

- [ ] Task 3: Update Library HOME routing back to Editor (AC: 4)
  - [ ] Change Library 'HOME' action to return to the Editor view (if the app uses routes, navigate to `/editor`; otherwise switch view state).
    [Source: docs/prd-session-timeline-smart-export.md#story-25-navigation-flow-optimization]
  - [ ] Likely touchpoints (verify in codebase): the Library panel component (e.g., `apps/boothy/src/components/panel/MainLibrary.tsx`) and any shared bottom navigation (e.g., `apps/boothy/src/components/panel/BottomBar.tsx`).
    [Source: docs/stories/1.1.booth-app-foundation-session-mode-gating.md#dev-agent-record]

- [ ] Task 4: Preserve session + selection + preset state across navigation (AC: 5)
  - [ ] Ensure active session context is preserved across routes (session folder + library root must remain constrained to the active session `Raw/` folder).
    [Source: docs/architecture/component-architecture.md#boothy-session-manager-tauri-backend]
    [Source: docs/stories/1.1.booth-app-foundation-session-mode-gating.md#acceptance-criteria]
  - [ ] Ensure selected photo persists when switching Editor <-> Library (do not clear selection unless session changes).
    [Source: docs/frontend-architecture.md#state-model-frontend]
  - [ ] Ensure the currently active preset UI selection remains intact across navigation (per-image assignments remain backend-driven; UI should not retroactively reassign).
    [Source: docs/frontend-architecture.md#state-model-frontend]
    [Source: docs/architecture/component-architecture.md#boothy-preset-assignment-service-tauri-backend]

- [ ] Task 5: Validate countdown timer visibility across routes (AC: 6)
  - [ ] Confirm countdown timer remains visible on both Editor and Library after route changes and does not restart/reset due to navigation.
    [Source: docs/stories/2.1.session-timeline-core-warning-system.md#acceptance-criteria]
    [Source: docs/prd-session-timeline-smart-export.md#story-25-navigation-flow-optimization]

- [ ] Task 6: Route guards and accessibility of screens (AC: 7)
  - [ ] If route guards exist, ensure direct-to-editor entry works without breaking deep links and all screens remain reachable.
    [Source: docs/prd-session-timeline-smart-export.md#story-25-navigation-flow-optimization]

- [ ] Task 7: Tests + validation scenarios (AC: 1-7)
  - [ ] Manual (MVP gate): verify session entry -> Editor, Editor -> Library via icon, Library -> Editor via HOME; verify selection/preset/session preserved; verify countdown visible on both screens.
    [Source: docs/architecture/testing-strategy.md#manual-testing-requirements-mvp-gate]
    [Source: docs/prd-session-timeline-smart-export.md#story-25-navigation-flow-optimization]
  - [ ] Regression: verify no loss of access to existing screens and no change to session folder constraints (`Raw/` input, `Jpg/` output).
    [Source: docs/architecture/testing-strategy.md#regression-testing]
    [Source: docs/architecture/component-architecture.md#component-interaction-diagram]

## Dev Notes

### Previous Story Insights

- Latest Epic 2 story file before this draft is `docs/stories/2.4.smart-export-decision-and-progress-ui.md` and is currently `Draft`; this story is being prepared ahead of completion by request.
  [Source: docs/stories/2.4.smart-export-decision-and-progress-ui.md#status]
- Countdown timer must remain visible on both Editor and Library screens; this story must not regress the timer UI placement/behavior while changing navigation.
  [Source: docs/stories/2.1.session-timeline-core-warning-system.md#acceptance-criteria]

### Navigation / Routing

- PRD-defined navigation changes:
  - Session entry completion should go to `/editor` (or equivalent Editor-first view)
  - Editor has a gallery icon to navigate to `/library` (or equivalent Library view)
  - Library HOME goes back to `/editor` (or equivalent Editor view)
  [Source: docs/prd-session-timeline-smart-export.md#story-25-navigation-flow-optimization]
  [Source: docs/prd-session-timeline-smart-export.md#navigation-flow-integration]

### State / Data Model Considerations

- Preserve session context across navigation:
  - Active session is the single source of truth and must remain constrained to the active session `Raw/` path.
  [Source: docs/architecture/component-architecture.md#boothy-session-manager-tauri-backend]
  [Source: docs/stories/1.1.booth-app-foundation-session-mode-gating.md#acceptance-criteria]
- Preserve selected image and preset selection in UI state (do not reset on route change).
  [Source: docs/frontend-architecture.md#state-model-frontend]
- Per-image preset assignment is backend-driven at ingest time; UI preset changes should only affect future imports (do not retroactively change prior images).
  [Source: docs/architecture/component-architecture.md#boothy-preset-assignment-service-tauri-backend]
  [Source: docs/architecture/data-models-and-schema-changes.md#boothyperimagestate-stored-in-rapidraw-rrdata]

### File Locations (Guidance)

- Product code locations:
  - React UI: `apps/boothy/src/`
  - Tauri backend: `apps/boothy/src-tauri/src/`
  [Source: docs/architecture/source-tree.md#new-file-organization]

### Testing Requirements

- MVP quality gate is scenario-based manual validation; keep this change low-risk and focused on routing without altering session folder contracts.
  [Source: docs/architecture/testing-strategy.md#manual-testing-requirements-mvp-gate]
  [Source: docs/architecture/component-architecture.md#component-interaction-diagram]

## Change Log

| Date | Version | Description | Author |
| --- | --- | --- | --- |
| 2026-01-15 | 0.1 | Initial draft created from Epic 2 PRD + architecture | Scrum Master (Bob) |

## Dev Agent Record

### Agent Model Used

TBD

### Debug Log References

TBD

### Completion Notes List

- [ ] TBD

### File List

#### New Files Created

- [ ] TBD

#### Modified Files

- [ ] TBD

## QA Results

TBD
